"use strict";(self.webpackChunkpikachu_volleyball_p2p_online=self.webpackChunkpikachu_volleyball_p2p_online||[]).push([[792],{1497:(e,t,r)=>{var i=r(4603),n=r(6787),a=r(592),o=r(3650),s=r(9449),l=r(7561),d=r(7049),c=r(3401),h=r(8077),y=r(4697),u=r(8505),m=(r(7229),r(94)),p=r(9505),g=r(1275),b=r(6546),I=r(1514),w=r(7147),f=r(5345),S=r(1674),P=r(653);class k extends m.q{constructor(e,t){super(e,t),this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.keyboardArray[0].unsubscribe(),this.keyboardArray[1].unsubscribe(),this.myKeyboard=p.Uq,this.myOnlineKeyboard=new p.Nz(this.myKeyboard.inputQueue),this.peerOnlineKeyboard=new p.Nz(g.Ix.peerInputQueue),this._amIPlayer2=!1,this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard],this._syncCounter=0,this.noInputFrameTotal.menu=1/0,this.isFirstGame=!0,this.willSaveReplay=!0}get amIPlayer2(){return this._amIPlayer2}set amIPlayer2(e){this._amIPlayer2=e,g.Ix.amIPlayer2=e,!0===this._amIPlayer2?this.keyboardArray=[this.peerOnlineKeyboard,this.myOnlineKeyboard]:this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard]}get syncCounter(){return this._syncCounter}set syncCounter(e){this._syncCounter=(0,b.z)(e,g.fg)}intro(){0===this.frameCounter&&(this.selectedWithWho=0,this.isFirstGame?(this.isFirstGame=!1,this.amIPlayer2=!g.Ix.amICreatedRoom):g.Ix.isQuickMatch&&(0,I.Dj)()),super.intro()}menu(){const e=this.selectedWithWho;super.menu(),this.selectedWithWho!==e&&(this.amIPlayer2=!this.amIPlayer2,(0,w.sb)(g.Ix.myNickname,this.amIPlayer2),(0,w.Si)(g.Ix.peerNickname,!this.amIPlayer2),(0,w.UI)(g.Ix.myPartialPublicIP,this.amIPlayer2),(0,w.UI)(g.Ix.peerPartialPublicIP,!this.amIPlayer2),(0,P.yL)(),(0,w.ue)())}gameLoop(){g.Ix.gameStartAllowed&&g.Ix.isOpen&&(this.myKeyboard.getInputIfNeededAndSendToPeer(this.syncCounter),this.gameLoopFromGettingPeerInput())}gameLoopFromGettingPeerInput(){if(this.peerOnlineKeyboard.isInputOnQueue(this.syncCounter)){if(this.myOnlineKeyboard.isInputOnQueue(this.syncCounter)){if(this.peerOnlineKeyboard.getInput(this.syncCounter),this.myOnlineKeyboard.getInput(this.syncCounter),this.syncCounter++,this.willSaveReplay){const e=new S.BF;e.xDirection=this.keyboardArray[0].xDirection,e.yDirection=this.keyboardArray[0].yDirection,e.powerHit=this.keyboardArray[0].powerHit;const t=new S.BF;t.xDirection=this.keyboardArray[1].xDirection,t.yDirection=this.keyboardArray[1].yDirection,t.powerHit=this.keyboardArray[1].powerHit,f.Z.recordInputs(e,t)}if(this.slowMotionFramesLeft>0){if(this.slowMotionNumOfSkippedFrames++,this.slowMotionNumOfSkippedFrames%Math.round(this.normalFPS/this.slowMotionFPS)!=0)return;this.slowMotionFramesLeft--,this.slowMotionNumOfSkippedFrames=0}this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.state(),this.peerOnlineKeyboard.inputQueue.length>p.$g&&(this.myOnlineKeyboard.inputQueue.length>p.$g?window.setTimeout(this.gameLoopFromGettingPeerInput.bind(this),0):window.setTimeout(this.gameLoop.bind(this),0))}}else g.Ix.callbackAfterPeerInputQueueReceived=this.gameLoopFromGettingPeerInput.bind(this)}}var C=r(6090),E=r(6650),A=r(3398),O=r(6006);const L="stringifiedbadWordListArrayView",x=(0,A.j)(),K="isDefaultBadWordFilterEnabled",v=document.getElementById("basic-chat-filter-checkbox"),F=document.getElementById("blocked-bad-words-table-container"),N=document.querySelector("table.blocked-bad-words-table tbody"),D=document.querySelector("table.blocked-bad-words-table .delete-btn"),_=document.getElementById("number-of-bad-words-addresses"),B=document.getElementById("add-custom-word-btn"),W=document.getElementById("new-custom-word-input");function T(e){for(;N.firstChild;)N.removeChild(N.firstChild);e.forEach(((e,t)=>{const r=document.createElement("tr"),i=document.createElement("td"),n=document.createElement("td");r.appendChild(i),r.appendChild(n),r.dataset.index=String(t),i.textContent=e[0],n.textContent=new Date(e[1]).toLocaleString(),N.appendChild(r)}))}function M(){_.textContent=String(O.Y.length)}function R(){Array.from(N.getElementsByTagName("tr")).forEach((e=>{e.classList.remove("selected")}))}const U=C.I.TEXTURES;U.WITH_COMPUTER=U.WITH_FRIEND,a.A4.registerPlugin("prepare",o.p8),a.A4.registerPlugin("batch",a.ch),h.KB.registerPlugin("prepare",u.S),h.KB.registerPlugin("sprite",y.$),l.aH.registerPlugin(d.A),i.W.RESOLUTION=2,i.W.SCALE_MODE=n.M6.NEAREST,i.W.ROUND_PIXELS=!0;const Y=(0,a.q5)({width:432,height:304,antialias:!1,backgroundColor:0,backgroundAlpha:1,forceCanvas:!0}),H=new s.mc,q=new c.Rv,G=new l.aH;document.querySelector("#game-canvas-container").appendChild(Y.view),Y.render(H),G.add(C.I.SPRITE_SHEET);for(const e in C.I.SOUNDS)G.add(C.I.SOUNDS[e]);function Q(){const e=new k(H,G.resources);(0,I.zD)(e,q),(0,P.yg)(e),function(e){q.maxFPS=e.normalFPS,q.add((()=>{Y.render(H),e.gameLoop()})),q.start()}(e)}!function(){const e=document.getElementById("loading-box"),t=document.getElementById("progress-bar");G.onProgress.add((()=>{t.style.width=`${G.progress}%`})),G.onComplete.add((()=>{e.classList.add("hidden")}))}(),g.Ix.callbackAfterDataChannelOpened=()=>{G.load(Q)},(0,I.aW)(),(0,E.G)(),function(){if(!x)return v.parentElement.classList.add("hidden"),void F.classList.add("hidden");!function(){let e=!0;try{const t=window.localStorage.getItem(K);null!==t&&(e="true"===t)}catch(e){console.log(e)}v.checked=e,O.Y.willUseBasicBadWords=e,v.addEventListener("change",(()=>{try{window.localStorage.setItem(K,String(v.checked))}catch(e){console.log(e)}}))}(),function(){if(D.disabled=!0,!x)return;let e=null;try{e=window.localStorage.getItem(L)}catch(e){console.log(e)}if(null!==e){const t=JSON.parse(e);t.length>0&&2!==t[0].length?(window.localStorage.removeItem(L),location.reload()):O.Y.readArrayViewAndUpdate(t)}T(O.Y.createArrayView()),M();let t=-1;document.body.addEventListener("click",(e=>{const r=e.target;if(N.contains(r)&&"TD"===r.tagName){const i=r.parentElement,n=i.sectionRowIndex;if(e.shiftKey&&-1!==t){e.ctrlKey||R();const r=Math.min(t,n),i=Math.max(t,n),a=N.getElementsByTagName("tr");for(let e=r;e<=i;e++)a[e]&&a[e].classList.add("selected")}else e.ctrlKey||R(),i.classList.toggle("selected"),t=n}else e.ctrlKey||e.shiftKey||R();D.disabled=!N.querySelector(".selected")})),D.addEventListener("click",(()=>{t=-1;const e=N.querySelectorAll(".selected");for(let t=e.length-1;t>=0;--t)O.Y.removeAt(Number(e[t].dataset.index));try{window.localStorage.setItem("stringifiedbadWordListArrayView",JSON.stringify(O.Y.createArrayView()))}catch(e){console.log(e)}T(O.Y.createArrayView()),M()})),B.addEventListener("click",(()=>{t=-1;const e=W.value.toLowerCase().replace(/[^\p{L}\p{Emoji}]/gu,"");if(e&&!O.Y.isFull()){O.Y.AddBadWords(e);try{window.localStorage.setItem(L,JSON.stringify(O.Y.createArrayView()))}catch(e){console.log(e)}T(O.Y.createArrayView()),M(),W.value=""}}))}()}()}},e=>{e.O(0,[244,415,476],(()=>e(e.s=1497))),e.O()}]);
//# sourceMappingURL=main.81e4404a1ff51eb1174f.js.map