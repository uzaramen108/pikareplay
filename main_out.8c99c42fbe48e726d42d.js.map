{"version":3,"file":"main_out.8c99c42fbe48e726d42d.js","mappings":"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","sources":["webpack://pikachu-volleyball-p2p-online/./src/resources/js/replay/main_out.js"],"sourcesContent":["/**\r\n * Main script for converting Pikachu Volleyball replay files to video\r\n * Real-time recording with MediaRecorder at 30 FPS\r\n * WITH EXTENSIVE DEBUGGING\r\n */\r\n'use strict';\r\nimport { settings } from '@pixi/settings';\r\nimport { SCALE_MODES } from '@pixi/constants';\r\nimport { Renderer, BatchRenderer, autoDetectRenderer } from '@pixi/core';\r\nimport { Prepare } from '@pixi/prepare';\r\nimport { Container } from '@pixi/display';\r\nimport { Loader } from '@pixi/loaders';\r\nimport { SpritesheetLoader } from '@pixi/spritesheet';\r\nimport { Ticker } from '@pixi/ticker';\r\nimport { CanvasRenderer } from '@pixi/canvas-renderer';\r\nimport { CanvasSpriteRenderer } from '@pixi/canvas-sprite';\r\nimport { CanvasPrepare } from '@pixi/canvas-prepare';\r\nimport '@pixi/canvas-display';\r\nimport { ASSETS_PATH } from '../offline_version_js/assets_path.js';\r\nimport { PikachuVolleyballReplay } from './pikavolley_replay.js';\r\nimport { setGetSpeechBubbleNeeded, enableChat } from '../chat_display.js';\r\nimport { serialize } from '../utils/serialize.js';\r\nimport { getHashCode } from '../utils/hash_code.js';\r\nimport '../../style.css';\r\n\r\nconsole.log('üé¨ [INIT] main_out.js loaded');\r\n\r\n/**\r\n * Replay to Video Converter with MediaRecorder (Real-time recording)\r\n */\r\nclass ReplayToVideoConverter {\r\n  constructor() {\r\n    console.log('üé¨ [CONSTRUCTOR] Creating ReplayToVideoConverter');\r\n    \r\n    // Setup PIXI\r\n    Renderer.registerPlugin('prepare', Prepare);\r\n    Renderer.registerPlugin('batch', BatchRenderer);\r\n    CanvasRenderer.registerPlugin('prepare', CanvasPrepare);\r\n    CanvasRenderer.registerPlugin('sprite', CanvasSpriteRenderer);\r\n    Loader.registerPlugin(SpritesheetLoader);\r\n    settings.RESOLUTION = 2;\r\n    settings.SCALE_MODE = SCALE_MODES.NEAREST;\r\n    settings.ROUND_PIXELS = true;\r\n\r\n    this.renderer = null;\r\n    this.stage = null;\r\n    this.loader = null;\r\n    this.ticker = null;\r\n    this.pikaVolley = null;\r\n    this.currentPack = null;\r\n    \r\n    this.mediaRecorder = null;\r\n    this.recordedChunks = [];\r\n    this.isRecording = false;\r\n    \r\n    console.log('‚úÖ [CONSTRUCTOR] ReplayToVideoConverter created');\r\n  }\r\n\r\n  updateStatus(message) {\r\n    const statusEl = document.getElementById('status');\r\n    console.log(`üìù [STATUS] ${message}`);\r\n    if (statusEl) {\r\n      statusEl.textContent = message;\r\n    }\r\n  }\r\n\r\n  handleRecordButtonClick() {\r\n    console.log('üîò [BUTTON] Record button clicked');\r\n    \r\n    if (this.isRecording) {\r\n      console.warn('‚ö†Ô∏è [BUTTON] Already recording!');\r\n      this.updateStatus('Ïù¥ÎØ∏ Ï≤òÎ¶¨ Ï§ëÏûÖÎãàÎã§...');\r\n      return;\r\n    }\r\n\r\n    console.log('üìÇ [BUTTON] Opening file picker...');\r\n    const fileInput = document.createElement('input');\r\n    fileInput.type = 'file';\r\n    fileInput.accept = '.txt';\r\n    fileInput.onchange = (e) => {\r\n      // @ts-ignore\r\n      const file = e.target.files[0];\r\n      console.log('üìÑ [FILE] File selected:', file?.name);\r\n      if (file) {\r\n        this.loadReplayFile(file);\r\n      }\r\n    };\r\n    fileInput.click();\r\n  }\r\n\r\n  loadReplayFile(file) {\r\n    console.log('üì• [LOAD] Loading replay file:', file.name);\r\n    this.updateStatus('Î¶¨ÌîåÎ†àÏù¥ ÌååÏùº Î°úÎî© Ï§ë...');\r\n    \r\n    const recordBtn = document.getElementById('record-btn');\r\n    console.log('üîò [LOAD] Record button element:', recordBtn);\r\n    // @ts-ignore\r\n    if (recordBtn) recordBtn.disabled = true;\r\n\r\n    // Show loading overlay\r\n    const loadingOverlay = document.getElementById('loading-overlay');\r\n    console.log('‚è≥ [LOAD] Loading overlay element:', loadingOverlay);\r\n    // @ts-ignore\r\n    if (loadingOverlay) {\r\n      loadingOverlay.classList.remove('hidden');\r\n      console.log('‚úÖ [LOAD] Loading overlay shown');\r\n    }\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = (event) => {\r\n      console.log('üìñ [LOAD] File read complete');\r\n      try {\r\n        // @ts-ignore\r\n        const packWithComment = JSON.parse(event.target.result);\r\n        console.log('üì¶ [LOAD] Pack parsed:', {\r\n          hasNicknames: !!packWithComment.pack?.nicknames,\r\n          nicknamesLength: packWithComment.pack?.nicknames?.length,\r\n          nicknames: packWithComment.pack?.nicknames,\r\n          hasIPs: !!packWithComment.pack?.partialPublicIPs,\r\n          IPs: packWithComment.pack?.partialPublicIPs,\r\n          hasChats: !!packWithComment.pack?.chats,\r\n          chatsLength: packWithComment.pack?.chats?.length,\r\n        });\r\n        \r\n        const pack = packWithComment.pack;\r\n        const hash = pack.hash;\r\n        pack.hash = 0;\r\n        if (hash !== getHashCode(serialize(pack))) {\r\n          throw new Error('ÌååÏùº ÎÇ¥Ïö©Ïù¥ Ìï¥Ïãú ÏΩîÎìúÏôÄ ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§');\r\n        }\r\n        console.log('‚úÖ [LOAD] Hash verification passed');\r\n        this.initializeRenderer(pack);\r\n      } catch (err) {\r\n        console.error('‚ùå [LOAD] Error loading file:', err);\r\n        // @ts-ignore\r\n        this.updateStatus('ÌååÏùº Î°úÎî© Ïã§Ìå®: ' + err.message);\r\n        // @ts-ignore\r\n        if (recordBtn) recordBtn.disabled = false;\r\n        // @ts-ignore\r\n        if (loadingOverlay) loadingOverlay.classList.add('hidden');\r\n      }\r\n    };\r\n    reader.onerror = () => {\r\n      console.error('‚ùå [LOAD] File read error');\r\n      this.updateStatus('ÌååÏùº ÏùΩÍ∏∞ Ïã§Ìå®');\r\n      // @ts-ignore\r\n      if (recordBtn) recordBtn.disabled = false;\r\n      // @ts-ignore\r\n      if (loadingOverlay) loadingOverlay.classList.add('hidden');\r\n    };\r\n    reader.readAsText(file);\r\n  }\r\n\r\n  initializeRenderer(pack) {\r\n    console.log('üé® [RENDERER] Initializing renderer...');\r\n    this.updateStatus('Í≤åÏûÑ ÏóêÏÖã Î°úÎî© Ï§ë...');\r\n    this.currentPack = pack;\r\n\r\n    // Setup renderer\r\n    this.renderer = autoDetectRenderer({\r\n      width: 432,\r\n      height: 304,\r\n      antialias: false,\r\n      backgroundColor: 0x000000,\r\n      backgroundAlpha: 1,\r\n      forceCanvas: true,\r\n      preserveDrawingBuffer: true,\r\n    });\r\n    console.log('‚úÖ [RENDERER] Renderer created');\r\n\r\n    this.stage = new Container();\r\n    this.ticker = new Ticker();\r\n    this.ticker.minFPS = 1;\r\n    this.loader = new Loader();\r\n    console.log('‚úÖ [RENDERER] Stage, ticker, loader created');\r\n\r\n    // Append canvas to container\r\n    const container = document.querySelector('#game-canvas-container');\r\n    console.log('üì¶ [RENDERER] Game container element:', container);\r\n    // @ts-ignore\r\n    container.innerHTML = '';\r\n    // @ts-ignore\r\n    container.appendChild(this.renderer.view);\r\n    console.log('‚úÖ [RENDERER] Canvas appended to container');\r\n\r\n    // Setup assets\r\n    const TEXTURES = ASSETS_PATH.TEXTURES;\r\n    TEXTURES.WITH_COMPUTER = TEXTURES.WITH_FRIEND;\r\n\r\n    this.loader.add(ASSETS_PATH.SPRITE_SHEET);\r\n    for (const prop in ASSETS_PATH.SOUNDS) {\r\n      this.loader.add(ASSETS_PATH.SOUNDS[prop]);\r\n    }\r\n    console.log('‚úÖ [RENDERER] Assets added to loader');\r\n\r\n    this.setupLoaderProgressBar();\r\n    this.loader.load(() => this.setupGame(pack));\r\n    console.log('üîÑ [RENDERER] Loading assets...');\r\n  }\r\n\r\n  setupLoaderProgressBar() {\r\n    const progressBar = document.getElementById('progress-bar');\r\n    console.log('üìä [PROGRESS] Progress bar element:', progressBar);\r\n    if (progressBar) {\r\n      this.loader.onProgress.add(() => {\r\n        // @ts-ignore\r\n        progressBar.style.width = `${this.loader.progress}%`;\r\n      });\r\n    }\r\n  }\r\n\r\n  setupGame(pack) {\r\n    console.log('üéÆ [GAME] Setting up game...');\r\n    console.log('üì¶ [GAME] Pack data:', {\r\n      nicknames: pack.nicknames,\r\n      IPs: pack.partialPublicIPs,\r\n      chatsCount: pack.chats?.length,\r\n      inputsCount: pack.inputs?.length,\r\n    });\r\n    this.updateStatus('Í≤åÏûÑ Ï¥àÍ∏∞Ìôî Ï§ë...');\r\n\r\n    // CRITICAL: Create DOM elements if they don't exist\r\n    console.log('üî® [DOM] Ensuring DOM elements exist...');\r\n    const container = document.getElementById('game-canvas-container');\r\n    if (container) {\r\n      // Create chat boxes if they don't exist\r\n      if (!document.getElementById('player1-chat-box')) {\r\n        const chatBox1 = document.createElement('div');\r\n        chatBox1.id = 'player1-chat-box';\r\n        chatBox1.className = 'chat-box pre-wrap';\r\n        container.appendChild(chatBox1);\r\n        console.log('‚úÖ [DOM] Created player1-chat-box');\r\n      }\r\n      \r\n      if (!document.getElementById('player2-chat-box')) {\r\n        const chatBox2 = document.createElement('div');\r\n        chatBox2.id = 'player2-chat-box';\r\n        chatBox2.className = 'chat-box pre-wrap';\r\n        container.appendChild(chatBox2);\r\n        console.log('‚úÖ [DOM] Created player2-chat-box');\r\n      }\r\n      \r\n      // Create nicknames container if it doesn't exist\r\n      if (!document.querySelector('.nicknames-container')) {\r\n        const nicknamesContainer = document.createElement('div');\r\n        nicknamesContainer.className = 'nicknames-container';\r\n        \r\n        // Player 1 side\r\n        const leftSide = document.createElement('div');\r\n        leftSide.className = 'nickname-and-partial-ip left';\r\n        const nick1 = document.createElement('span');\r\n        nick1.id = 'player1-nickname';\r\n        nick1.className = 'nickname';\r\n        const ip1 = document.createElement('span');\r\n        ip1.id = 'player1-partial-ip';\r\n        ip1.className = 'partial-ip';\r\n        leftSide.appendChild(nick1);\r\n        leftSide.appendChild(ip1);\r\n        \r\n        // Player 2 side\r\n        const rightSide = document.createElement('div');\r\n        rightSide.className = 'nickname-and-partial-ip right';\r\n        const nick2 = document.createElement('span');\r\n        nick2.id = 'player2-nickname';\r\n        nick2.className = 'nickname';\r\n        const ip2 = document.createElement('span');\r\n        ip2.id = 'player2-partial-ip';\r\n        ip2.className = 'partial-ip';\r\n        rightSide.appendChild(nick2);\r\n        rightSide.appendChild(ip2);\r\n        \r\n        nicknamesContainer.appendChild(leftSide);\r\n        nicknamesContainer.appendChild(rightSide);\r\n        container.appendChild(nicknamesContainer);\r\n        console.log('‚úÖ [DOM] Created nicknames container');\r\n      }\r\n      \r\n      // Create chat disabled elements if they don't exist\r\n      if (!document.getElementById('player1-chat-disabled')) {\r\n        const chatDisabled1 = document.createElement('div');\r\n        chatDisabled1.id = 'player1-chat-disabled';\r\n        chatDisabled1.className = 'hidden';\r\n        container.appendChild(chatDisabled1);\r\n        console.log('‚úÖ [DOM] Created player1-chat-disabled');\r\n      }\r\n      \r\n      if (!document.getElementById('player2-chat-disabled')) {\r\n        const chatDisabled2 = document.createElement('div');\r\n        chatDisabled2.id = 'player2-chat-disabled';\r\n        chatDisabled2.className = 'hidden';\r\n        container.appendChild(chatDisabled2);\r\n        console.log('‚úÖ [DOM] Created player2-chat-disabled');\r\n      }\r\n    }\r\n\r\n    // Check DOM elements BEFORE creating game\r\n    console.log('üîç [DOM] Checking DOM elements...');\r\n    const chatBox1 = document.getElementById('player1-chat-box');\r\n    const chatBox2 = document.getElementById('player2-chat-box');\r\n    const nick1 = document.getElementById('player1-nickname');\r\n    const nick2 = document.getElementById('player2-nickname');\r\n    const ip1 = document.getElementById('player1-partial-ip');\r\n    const ip2 = document.getElementById('player2-partial-ip');\r\n    const chatDisabled1 = document.getElementById('player1-chat-disabled');\r\n    const chatDisabled2 = document.getElementById('player2-chat-disabled');\r\n    \r\n    console.log('üìã [DOM] Chat boxes:', { chatBox1, chatBox2 });\r\n    console.log('üìã [DOM] Nicknames:', { nick1, nick2 });\r\n    console.log('üìã [DOM] IPs:', { ip1, ip2 });\r\n    console.log('üìã [DOM] Chat disabled:', { chatDisabled1, chatDisabled2 });\r\n\r\n    console.log('üéÆ [GAME] Creating PikachuVolleyballReplay...');\r\n    this.pikaVolley = new PikachuVolleyballReplay(\r\n      this.stage,\r\n      this.loader.resources,\r\n      pack.roomID,\r\n      pack.nicknames,\r\n      pack.partialPublicIPs,\r\n      pack.inputs,\r\n      pack.options,\r\n      pack.chats\r\n    );\r\n    console.log('‚úÖ [GAME] PikachuVolleyballReplay created');\r\n\r\n    // Set speech bubble function\r\n    console.log('üí¨ [GAME] Setting speech bubble function...');\r\n    try {\r\n      // @ts-ignore\r\n      setGetSpeechBubbleNeeded(this.pikaVolley);\r\n      console.log('‚úÖ [GAME] Speech bubble function set');\r\n    } catch (err) {\r\n      console.error('‚ùå [GAME] Error setting speech bubble:', err);\r\n    }\r\n\r\n    // Enable chat display\r\n    console.log('üí¨ [GAME] Enabling chat display...');\r\n    this.pikaVolley.willDisplayChat = true;\r\n    try {\r\n      enableChat(true);\r\n      console.log('‚úÖ [GAME] Chat enabled');\r\n    } catch (err) {\r\n      console.error('‚ùå [GAME] Error enabling chat:', err);\r\n    }\r\n\r\n    // Enable nickname and IP display by checking checkboxes programmatically\r\n    console.log('‚òëÔ∏è [CHECKBOX] Activating checkboxes...');\r\n    const showNicknamesCheckbox = document.getElementById('show-nicknames-checkbox');\r\n    const showIPsCheckbox = document.getElementById('show-ip-addresses-checkbox');\r\n    const showChatCheckbox = document.getElementById('show-chat-checkbox');\r\n    \r\n    console.log('üìã [CHECKBOX] Checkbox elements:', {\r\n      nicknames: showNicknamesCheckbox,\r\n      ips: showIPsCheckbox,\r\n      chat: showChatCheckbox,\r\n    });\r\n    \r\n    if (showNicknamesCheckbox) {\r\n      console.log('‚òëÔ∏è [CHECKBOX] Activating nicknames checkbox...');\r\n      // @ts-ignore\r\n      showNicknamesCheckbox.checked = true;\r\n      showNicknamesCheckbox.dispatchEvent(new Event('change'));// @ts-ignore\r\n      console.log('‚úÖ [CHECKBOX] Nicknames checkbox activated, checked:', showNicknamesCheckbox.checked);\r\n    } else {\r\n      console.warn('‚ö†Ô∏è [CHECKBOX] Nicknames checkbox not found!');\r\n    }\r\n    \r\n    if (showIPsCheckbox) {\r\n      console.log('‚òëÔ∏è [CHECKBOX] Activating IPs checkbox...');\r\n      // @ts-ignore\r\n      showIPsCheckbox.checked = true;\r\n      showIPsCheckbox.dispatchEvent(new Event('change'));// @ts-ignore\r\n      console.log('‚úÖ [CHECKBOX] IPs checkbox activated, checked:', showIPsCheckbox.checked);\r\n    } else {\r\n      console.warn('‚ö†Ô∏è [CHECKBOX] IPs checkbox not found!');\r\n    }\r\n    \r\n    if (showChatCheckbox) {\r\n      console.log('‚òëÔ∏è [CHECKBOX] Activating chat checkbox...');\r\n      // @ts-ignore\r\n      showChatCheckbox.checked = true;\r\n      showChatCheckbox.dispatchEvent(new Event('change'));// @ts-ignore\r\n      console.log('‚úÖ [CHECKBOX] Chat checkbox activated, checked:', showChatCheckbox.checked);\r\n    } else {\r\n      console.warn('‚ö†Ô∏è [CHECKBOX] Chat checkbox not found!');\r\n    }\r\n\r\n    // Check DOM elements AFTER checkbox activation\r\n    console.log('üîç [DOM] Checking DOM elements AFTER checkbox activation...');\r\n    console.log('üìã [DOM] Nickname classes:', {\r\n      nick1: nick1?.className,\r\n      nick2: nick2?.className,\r\n    });\r\n    console.log('üìã [DOM] IP classes:', {\r\n      ip1: ip1?.className,\r\n      ip2: ip2?.className,\r\n    });\r\n\r\n    // Disable BGM completely\r\n    console.log('üîá [AUDIO] Disabling BGM...');\r\n    this.pikaVolley.audio.turnBGMVolume(false);\r\n    if (this.pikaVolley.audio.sounds.bgm && this.pikaVolley.audio.sounds.bgm.center) {\r\n      this.pikaVolley.audio.sounds.bgm.center.stop();\r\n      // Override play method to prevent BGM\r\n      // @ts-ignore\r\n      this.pikaVolley.audio.sounds.bgm.center.play = function() {\r\n        console.log('üîá [AUDIO] BGM play blocked');\r\n      };\r\n      // @ts-ignore\r\n      this.pikaVolley.audio.sounds.bgm.center.isPlaying = false;\r\n    }\r\n    console.log('‚úÖ [AUDIO] BGM disabled');\r\n\r\n    // Enable SFX (sound effects)\r\n    console.log('üîä [AUDIO] Enabling SFX...');\r\n    this.pikaVolley.audio.turnSFXVolume(true);\r\n    console.log('‚úÖ [AUDIO] SFX enabled');\r\n\r\n    // Setup ticker for rendering\r\n    console.log('üîÑ [TICKER] Setting up ticker...');\r\n    this.ticker.add(() => {\r\n      this.renderer.render(this.stage);\r\n      this.pikaVolley.gameLoop();\r\n    });\r\n    console.log('‚úÖ [TICKER] Ticker set up');\r\n\r\n    setTimeout(() => this.startRecording(), 100);\r\n    console.log('‚è∞ [GAME] Recording will start in 100ms');\r\n  }\r\n\r\n  startRecording() {\r\n    console.log('üé• [RECORD] Starting recording...');\r\n    this.updateStatus('ÎÖπÌôî Ï§ÄÎπÑ Ï§ë...');\r\n    this.recordedChunks = [];\r\n    this.isRecording = true;\r\n\r\n    // @ts-ignore\r\n    const canvas = this.renderer.view;\r\n    console.log('üñºÔ∏è [RECORD] Canvas:', canvas);\r\n    \r\n    try {\r\n      // Create canvas stream at 30 FPS\r\n      const fps = 30;\r\n      // @ts-ignore\r\n      const canvasStream = canvas.captureStream(fps);\r\n      console.log('üìπ [RECORD] Canvas stream created at', fps, 'FPS');\r\n\r\n      // Setup MediaRecorder\r\n      let mimeType = 'video/webm;codecs=vp9';\r\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n        console.warn('‚ö†Ô∏è [RECORD] VP9 not supported, trying VP8');\r\n        mimeType = 'video/webm;codecs=vp8';\r\n        if (!MediaRecorder.isTypeSupported(mimeType)) {\r\n          console.warn('‚ö†Ô∏è [RECORD] VP8 not supported, using default webm');\r\n          mimeType = 'video/webm';\r\n        }\r\n      }\r\n      console.log('‚úÖ [RECORD] Using codec:', mimeType);\r\n\r\n      this.mediaRecorder = new MediaRecorder(canvasStream, {\r\n        mimeType: mimeType,\r\n        videoBitsPerSecond: 2500000, // 2.5 Mbps\r\n      });\r\n      console.log('‚úÖ [RECORD] MediaRecorder created');\r\n\r\n      this.mediaRecorder.ondataavailable = (e) => {\r\n        if (e.data.size > 0) {\r\n          this.recordedChunks.push(e.data);\r\n          console.log(`üì¶ [RECORD] Data chunk received: ${e.data.size} bytes, total chunks: ${this.recordedChunks.length}`);\r\n        }\r\n      };\r\n\r\n      this.mediaRecorder.onstop = () => {\r\n        console.log('‚èπÔ∏è [RECORD] MediaRecorder stopped');\r\n        this.saveVideoFile();\r\n      };\r\n\r\n      this.mediaRecorder.onerror = (e) => {\r\n        console.error('‚ùå [RECORD] MediaRecorder error:', e);\r\n        this.updateStatus('ÎÖπÌôî Ï§ë ÏóêÎü¨ Î∞úÏÉù');\r\n        this.isRecording = false;\r\n        const recordBtn = document.getElementById('record-btn');\r\n        // @ts-ignore\r\n        if (recordBtn) recordBtn.disabled = false;\r\n      };\r\n\r\n      // Start recording\r\n      this.mediaRecorder.start(100); // Collect data every 100ms\r\n      console.log('‚ñ∂Ô∏è [RECORD] MediaRecorder started');\r\n\r\n      // Start game ticker at 30 FPS\r\n      this.ticker.maxFPS = 30;\r\n      this.ticker.start();\r\n      console.log('‚ñ∂Ô∏è [TICKER] Ticker started at 30 FPS');\r\n\r\n      this.updateStatus(`ÎÖπÌôî Ï§ë... 0%`);\r\n      this.monitorProgress();\r\n      console.log('üìä [RECORD] Progress monitoring started');\r\n\r\n    } catch (err) {\r\n      console.error('‚ùå [RECORD] Error starting recording:', err);\r\n      // @ts-ignore\r\n      this.updateStatus('ÎÖπÌôî ÏãúÏûë Ïã§Ìå®: ' + err.message);\r\n      this.isRecording = false;\r\n      const recordBtn = document.getElementById('record-btn');\r\n      // @ts-ignore\r\n      if (recordBtn) recordBtn.disabled = false;\r\n    }\r\n  }\r\n\r\n  monitorProgress() {\r\n    const totalFrames = this.pikaVolley.inputs.length;\r\n    console.log('üìä [PROGRESS] Total frames:', totalFrames);\r\n    const progressBar = document.getElementById('progress-bar');\r\n    \r\n    const checkInterval = setInterval(() => {\r\n      if (!this.pikaVolley || !this.isRecording) {\r\n        console.log('‚èπÔ∏è [PROGRESS] Stopping progress monitoring');\r\n        clearInterval(checkInterval);\r\n        return;\r\n      }\r\n\r\n      const currentFrame = this.pikaVolley.replayFrameCounter;\r\n      const progress = Math.floor((currentFrame / totalFrames) * 100);\r\n      \r\n      if (currentFrame % 100 === 0) {\r\n        console.log(`üìä [PROGRESS] Frame ${currentFrame}/${totalFrames} (${progress}%)`);\r\n      }\r\n      \r\n      this.updateStatus(`ÎÖπÌôî Ï§ë... ${progress}%`);\r\n      if (progressBar) {\r\n        // @ts-ignore\r\n        progressBar.style.width = `${progress}%`;\r\n      }\r\n\r\n      if (currentFrame >= totalFrames) {\r\n        console.log('üèÅ [PROGRESS] All frames processed');\r\n        clearInterval(checkInterval);\r\n        this.stopRecording();\r\n      }\r\n    }, 500);\r\n  }\r\n\r\n  stopRecording() {\r\n    if (!this.isRecording) {\r\n      console.log('‚ö†Ô∏è [STOP] Not recording, skipping stop');\r\n      return;\r\n    }\r\n\r\n    console.log('‚èπÔ∏è [STOP] Stopping recording...');\r\n    this.updateStatus('ÎÖπÌôî ÏôÑÎ£å, ÌååÏùº Ï†ÄÏû• Ï§ë...');\r\n    this.ticker.stop();\r\n    console.log('‚èπÔ∏è [STOP] Ticker stopped');\r\n    \r\n    if (this.mediaRecorder && this.mediaRecorder.state !== 'inactive') {\r\n      console.log('‚èπÔ∏è [STOP] Stopping MediaRecorder...');\r\n      this.mediaRecorder.stop();\r\n    } else {\r\n      console.log('‚ö†Ô∏è [STOP] MediaRecorder already inactive, saving directly');\r\n      this.saveVideoFile();\r\n    }\r\n  }\r\n\r\n  saveVideoFile() {\r\n    console.log('üíæ [SAVE] Saving video file...');\r\n    console.log('üì¶ [SAVE] Recorded chunks:', this.recordedChunks.length);\r\n    \r\n    if (this.recordedChunks.length === 0) {\r\n      console.error('‚ùå [SAVE] No recorded data!');\r\n      this.updateStatus('ÎÖπÌôîÎêú Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§');\r\n      this.isRecording = false;\r\n      const recordBtn = document.getElementById('record-btn');\r\n      // @ts-ignore\r\n      if (recordBtn) recordBtn.disabled = false;\r\n      return;\r\n    }\r\n\r\n    const blob = new Blob(this.recordedChunks, { type: 'video/webm' });\r\n    console.log('üì¶ [SAVE] Blob created:', blob.size, 'bytes');\r\n    const url = URL.createObjectURL(blob);\r\n    console.log('üîó [SAVE] Object URL:', url);\r\n    \r\n    const d = new Date();\r\n    const dateStr = `${d.getFullYear()}${('0' + (d.getMonth() + 1)).slice(-2)}${('0' + d.getDate()).slice(-2)}`;\r\n    const timeStr = `${('0' + d.getHours()).slice(-2)}${('0' + d.getMinutes()).slice(-2)}`;\r\n    \r\n    let filename = `${dateStr}_${timeStr}_pikavolley_replay.webm`;\r\n    \r\n    const pack = this.currentPack;\r\n    if (pack && pack.nicknames && pack.nicknames.length === 2) {\r\n      const nick1 = pack.nicknames[0].replace(/[/\\\\?%*:|\"<>]/g, '_');\r\n      const nick2 = pack.nicknames[1].replace(/[/\\\\?%*:|\"<>]/g, '_');\r\n      filename = `${dateStr}_${timeStr}_${nick1}_vs_${nick2}.webm`;\r\n    }\r\n    console.log('üìù [SAVE] Filename:', filename);\r\n\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = filename;\r\n    a.style.display = 'none';\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    console.log('‚úÖ [SAVE] Download triggered');\r\n    \r\n    setTimeout(() => {\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n      console.log('üßπ [SAVE] Cleanup complete');\r\n    }, 100);\r\n\r\n    this.updateStatus('ÏôÑÎ£å! Îã§Î•∏ Î¶¨ÌîåÎ†àÏù¥Î•º Î≥ÄÌôòÌïòÎ†§Î©¥ Î≤ÑÌäºÏùÑ Îã§Ïãú ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.');\r\n    this.isRecording = false;\r\n    const recordBtn = document.getElementById('record-btn');\r\n    // @ts-ignore\r\n    if (recordBtn) recordBtn.disabled = false;\r\n    this.recordedChunks = [];\r\n    \r\n    // Hide loading overlay\r\n    const loadingOverlay = document.getElementById('loading-overlay');\r\n    // @ts-ignore\r\n    if (loadingOverlay) loadingOverlay.classList.add('hidden');\r\n    console.log('‚úÖ [SAVE] Complete!');\r\n  }\r\n}\r\n\r\n// Adjust assets path\r\nfunction adjustAssetsPath() {\r\n  console.log('üîß [ASSETS] Adjusting assets path...');\r\n  ASSETS_PATH.SPRITE_SHEET = '../' + ASSETS_PATH.SPRITE_SHEET;\r\n  for (const prop in ASSETS_PATH.SOUNDS) {\r\n    ASSETS_PATH.SOUNDS[prop] = '../' + ASSETS_PATH.SOUNDS[prop];\r\n  }\r\n  console.log('‚úÖ [ASSETS] Assets path adjusted');\r\n}\r\n\r\nadjustAssetsPath();\r\n\r\n// Initialize converter\r\nconsole.log('üé¨ [INIT] Initializing converter...');\r\nconst converter = new ReplayToVideoConverter();\r\nconst recordBtn = document.getElementById('record-btn');\r\nconsole.log('üîò [INIT] Record button:', recordBtn);\r\nif (recordBtn) {\r\n  recordBtn.addEventListener('click', () => converter.handleRecordButtonClick());\r\n  console.log('‚úÖ [INIT] Record button listener attached');\r\n}\r\n\r\n// Setup UI event listeners for nickname/IP/chat display\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  console.log('üìÑ [DOM] DOMContentLoaded event fired');\r\n  \r\n  const showNicknamesCheckbox = document.getElementById('show-nicknames-checkbox');\r\n  const showIPsCheckbox = document.getElementById('show-ip-addresses-checkbox');\r\n  const showChatCheckbox = document.getElementById('show-chat-checkbox');\r\n  \r\n  const player1NicknameElem = document.getElementById('player1-nickname');\r\n  const player2NicknameElem = document.getElementById('player2-nickname');\r\n  const player1IPElem = document.getElementById('player1-partial-ip');\r\n  const player2IPElem = document.getElementById('player2-partial-ip');\r\n\r\n  console.log('üîç [DOM] UI Elements:', {\r\n    showNicknamesCheckbox,\r\n    showIPsCheckbox,\r\n    showChatCheckbox,\r\n    player1NicknameElem,\r\n    player2NicknameElem,\r\n    player1IPElem,\r\n    player2IPElem,\r\n  });\r\n\r\n  if (showNicknamesCheckbox) {\r\n    showNicknamesCheckbox.addEventListener('change', () => {// @ts-ignore\r\n      console.log('‚òëÔ∏è [EVENT] Nicknames checkbox changed:', showNicknamesCheckbox.checked);\r\n      // @ts-ignore\r\n      if (showNicknamesCheckbox.checked) {\r\n        if (player1NicknameElem) {\r\n          player1NicknameElem.classList.remove('hidden');\r\n          console.log('‚úÖ [EVENT] Player1 nickname shown');\r\n        }\r\n        if (player2NicknameElem) {\r\n          player2NicknameElem.classList.remove('hidden');\r\n          console.log('‚úÖ [EVENT] Player2 nickname shown');\r\n        }\r\n      } else {\r\n        if (player1NicknameElem) player1NicknameElem.classList.add('hidden');\r\n        if (player2NicknameElem) player2NicknameElem.classList.add('hidden');\r\n      }\r\n    });\r\n    console.log('‚úÖ [DOM] Nicknames checkbox listener attached');\r\n  }\r\n\r\n  if (showIPsCheckbox) {\r\n    showIPsCheckbox.addEventListener('change', () => {// @ts-ignore\r\n      console.log('‚òëÔ∏è [EVENT] IPs checkbox changed:', showIPsCheckbox.checked);\r\n      // @ts-ignore\r\n      if (showIPsCheckbox.checked) {\r\n        if (player1IPElem) {\r\n          player1IPElem.classList.remove('hidden');\r\n          console.log('‚úÖ [EVENT] Player1 IP shown');\r\n        }\r\n        if (player2IPElem) {\r\n          player2IPElem.classList.remove('hidden');\r\n          console.log('‚úÖ [EVENT] Player2 IP shown');\r\n        }\r\n      } else {\r\n        if (player1IPElem) player1IPElem.classList.add('hidden');\r\n        if (player2IPElem) player2IPElem.classList.add('hidden');\r\n      }\r\n    });\r\n    console.log('‚úÖ [DOM] IPs checkbox listener attached');\r\n  }\r\n\r\n  if (showChatCheckbox) {\r\n    showChatCheckbox.addEventListener('change', () => {\r\n    // @ts-ignore\r\n      console.log('‚òëÔ∏è [EVENT] Chat checkbox changed:', showChatCheckbox.checked);\r\n      // @ts-ignore\r\n      if (showChatCheckbox.checked) {\r\n        console.log('üí¨ [EVENT] Enabling chat...');\r\n        try {\r\n          enableChat(true);\r\n          console.log('‚úÖ [EVENT] Chat enabled');\r\n        } catch (err) {\r\n          console.error('‚ùå [EVENT] Error enabling chat:', err);\r\n        }\r\n      } else {\r\n        console.log('üîá [EVENT] Disabling chat...');\r\n        try {\r\n          enableChat(false);\r\n          console.log('‚úÖ [EVENT] Chat disabled');\r\n        } catch (err) {\r\n          console.error('‚ùå [EVENT] Error disabling chat:', err);\r\n        }\r\n      }\r\n    });\r\n    console.log('‚úÖ [DOM] Chat checkbox listener attached');\r\n  }\r\n});\r\n\r\nconsole.log('‚úÖ [INIT] main_out.js initialization complete');\r\n"],"names":["console","log","SPRITE_SHEET","prop","SOUNDS","adjustAssetsPath","converter","constructor","registerPlugin","RESOLUTION","SCALE_MODE","NEAREST","ROUND_PIXELS","this","renderer","stage","loader","ticker","pikaVolley","currentPack","mediaRecorder","recordedChunks","isRecording","updateStatus","message","statusEl","document","getElementById","textContent","handleRecordButtonClick","warn","fileInput","createElement","type","accept","onchange","e","file","target","files","name","loadReplayFile","click","recordBtn","disabled","loadingOverlay","classList","remove","reader","FileReader","onload","event","packWithComment","JSON","parse","result","hasNicknames","pack","nicknames","nicknamesLength","length","hasIPs","partialPublicIPs","IPs","hasChats","chats","chatsLength","hash","Error","initializeRenderer","err","error","add","onerror","readAsText","width","height","antialias","backgroundColor","backgroundAlpha","forceCanvas","preserveDrawingBuffer","minFPS","container","querySelector","innerHTML","appendChild","view","TEXTURES","WITH_COMPUTER","WITH_FRIEND","setupLoaderProgressBar","load","setupGame","progressBar","onProgress","style","progress","chatsCount","inputsCount","inputs","chatBox1","id","className","chatBox2","nicknamesContainer","leftSide","nick1","ip1","rightSide","nick2","ip2","chatDisabled1","chatDisabled2","resources","roomID","options","willDisplayChat","showNicknamesCheckbox","showIPsCheckbox","showChatCheckbox","ips","chat","checked","dispatchEvent","Event","audio","turnBGMVolume","sounds","bgm","center","stop","play","isPlaying","turnSFXVolume","render","gameLoop","setTimeout","startRecording","canvas","fps","canvasStream","captureStream","mimeType","MediaRecorder","isTypeSupported","videoBitsPerSecond","ondataavailable","data","size","push","onstop","saveVideoFile","start","maxFPS","monitorProgress","totalFrames","checkInterval","setInterval","clearInterval","currentFrame","replayFrameCounter","Math","floor","stopRecording","state","blob","Blob","url","URL","createObjectURL","d","Date","dateStr","getFullYear","getMonth","slice","getDate","timeStr","getHours","getMinutes","filename","replace","a","href","download","display","body","removeChild","revokeObjectURL","addEventListener","player1NicknameElem","player2NicknameElem","player1IPElem","player2IPElem"],"sourceRoot":""}